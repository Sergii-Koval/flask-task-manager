{% extends 'base.html' %}

{% block content %}
<h1>Tasks pending</h1>
    {% if 'user_id' in session and current_user.role in ['admin', 'dev'] %}
    <a href="{{ url_for('create_task') }}">Create Task</a>
{% endif %}
<table>
    {% for task in pending_tasks %}
    <tr>
        <td>{{ task.id }}</td>
        <td>{{ task.title }}</td>
        <td>{{ task.description }}</td>
        <td>{{ task.status }}</td>
        <td>{{ task.user.name if task.user else 'N/A' }}</td>
        <td>{{ task.done_time if task.done_time else 'N/A' }}</td>
        {% if 'user_id' in session and current_user.role in ['admin', 'dev'] %}
            <td><a href="{{ url_for('edit_task', id=task.id) }}">Edit</a></td>
            <td>
                <form action="{{ url_for('delete_task', id=task.id) }}" method="post">
                    <input type="submit" value="Delete">
                </form>
            </td>
        {% endif %}
    </tr>
    {% endfor %}
</table>

<h1>Tasks in development</h1>
<table>
    {% for task in in_progress_tasks %}
    <tr>
        <td>{{ task.id }}</td>
        <td>{{ task.title }}</td>
        <td>{{ task.description }}</td>
        <td>{{ task.status }}</td>
        <td>{{ task.user.name if task.user else 'N/A' }}</td>
        <td>{{ task.done_time if task.done_time else 'N/A' }}</td>
        {% if 'user_id' in session and current_user.role in ['admin', 'dev'] %}
            <td><a href="{{ url_for('edit_task', id=task.id) }}">Edit</a></td>
            <td>
                <form action="{{ url_for('delete_task', id=task.id) }}" method="post">
                    <input type="submit" value="Delete">
                </form>
            </td>
        {% endif %}
    </tr>
    {% endfor %}
</table>

<h1>Completed tasks</h1>
<table>
    {% for task in done_tasks %}
    <tr>
        <td>{{ task.id }}</td>
        <td>{{ task.title }}</td>
        <td>{{ task.description }}</td>
        <td>{{ task.status }}</td>
        <td>{{ task.user.name if task.user else 'N/A' }}</td>
        <td>{{ task.done_time if task.done_time else 'N/A' }}</td>
        {% if 'user_id' in session and current_user.role in ['admin', 'dev'] %}
            <td><a href="{{ url_for('edit_task', id=task.id) }}">Edit</a></td>
            <td>
                <form action="{{ url_for('delete_task', id=task.id) }}" method="post">
                    <input type="submit" value="Delete">
                </form>
            </td>
        {% endif %}
    </tr>
    {% endfor %}
</table>
{% endblock %}
